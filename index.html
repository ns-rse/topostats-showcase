<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/quarto-contrib/reveal-header-1.0.0/add_header.js" defer="true"></script>
<link href="site_libs/quarto-contrib/reveal-header-1.0.0/add_header.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/grid-htext-1.0.0/grid_htext.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/qrcodejs-v1.0.0/qrcode.js"></script><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Neil Shephard, Research Software Engineer">
  <title>Research Software Engineering - TopoStats Case Study ‚Äì Research Software Engineering : TopoStat Case Study</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-e050a9a4a806e7fb046a8732152c4fd1.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Research Software Engineering : TopoStat Case Study</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Neil Shephard, Research Software Engineer <a href="https://orcid.org/0000-0001-8301-6857" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:n.shephard@sheffield.ac.uk">n.shephard@sheffield.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            Department of Computer Science
          </p>
    </div>
</div>

</section>
<section id="scan-this" class="slide level2">
<h2><span style="color:white">Scan This</span></h2>
<div id="id=" "="" class="qrcode"></div>
<script type="text/javascript">
(function() {
  var script = document.currentScript;
  var qrcode = script.previousElementSibling;
  qrcode.qrcode = new QRCode(qrcode, {"colorDark":"#000000","colorLight":"#ffffff","height":"400","text":"<https://ns-rse.github.io/topostats-showcase>","width":"400"});
  script.remove();
})();
</script>
    
<p><a href="https://ns-rse.github.io/topostats-showcase" target="_blank">ns-rse.github.io/topostats-showcase</a></p>
</section>
<section id="who-am-i" class="slide level2">
<h2><span style="color:white">Who Am I?</span></h2>
<ul>
<li>Research Software Engineer</li>
<li>Education
<ul>
<li>BSc Zoology &amp; Genetics</li>
<li>MSc Genetic Epidemiology</li>
</ul></li>
<li>Background
<ul>
<li>~9 years Genetics Statistician</li>
<li>~8 years Medical Statistician</li>
<li>~4 years Data Scientist at Telematics Company</li>
</ul></li>
</ul>
<aside class="notes">
<p>Hi, my name is Neil Shephard and I‚Äôm a Research Software Engineer in the RSE Team based in the Department of Computer Science.</p>
<p>Before I get onto showcasing the TopoStats project I thought it would be useful to give some information on who I am and why I‚Äôm here talking to you today about Research Software Engineering and its benefits.</p>
<p>I studied Zoology and Genetics at undergraduate and then undertook a Masters in Genetic Epidemiology which is the statistical side of mapping genetic polymorphisms that influence diseases with a heritable component. I then spent just under 10 years working as a Genetics Statistician at University of Manchester, Western Australia and then back in Sheffield before moving sideways into Clinical Trials where I worked as a Medical Statistician for about 8 years.</p>
<p>Throughout this time I developed a passion for reproducible research, mainly motivated by finding using Word Processors and Spreadsheets really slow and tedious to work with. I was learnt some basic C and Fortran programming but have fortunately left those way behind me and taught myself the R statistical programming language and started using Git to version control my work.</p>
<p>I fancied another career change and found a position as a Data Scientist at a Telematics Company which used data from black boxes and mobile phones to, purportedly, determine your risk for insurance companies. During this time I learnt more formal aspects of code development, learning how to use Git in a collaborative setting, the Python programming language and good software design principles including testing and continuous integration.</p>
<p>Somewhat disillusioned with telematics I decided to return to academia and found a niche where I could combine my skills and knowledge about reproducible research and software development in the role of Research Software Engineer and I‚Äôve been in this position for three years now.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="topostats" class="slide level2">
<h2><span style="color:white">TopoStats</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Python Package</li>
<li><a href="https://pyne-lab.uk/" target="_blank">Pyne Lab</a> (School of Chemical, Materials and Biological Engineering)</li>
<li>Batch processing Atomic Force Microscopy (AFM)</li>
<li>Image DNA, RNA, Proteins, Perovskite, silicone, bacteria and more!</li>
</ul>
<p><a href="https://www.youtube.com/watch?v=99l0Jh7Bx14" target="_blank">TopoStats development</a></p>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/afm_block_diagram.png"></p>
<figcaption>AFM Scanning (<a href="https://commons.wikimedia.org/w/index.php?curid=3592868" target="_blank">Public Domain</a>)</figcaption>
</figure>
</div>
</div></div>
<aside class="notes">
<p>When I started in my role as an RSE the first project I was assigned to work on was TopoStats. It is software written in the popular Python language developed by the Pyne Lab.</p>
<p>Atomic Force Microscopy involves taking high resolution images of samples right down to the molecular level. Its kind of like a record player as you have a a cantilever tip that is very, very sensitive. A laser is bounced off the back of the tip and as the tip moves up and down over a surface the changes in height are detected and recorded.</p>
<p>This allows imaging of molecules such as DNA, RNA, proteins through to bacterial cells depending on the resolution. Its also applied to non-biological materials such as silicone wafers which are used in CPUs and perovskite, a material which can be used to produce solar cells.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="topostats-cont." class="slide level2">
<h2><span style="color:white">TopoStats (cont.)</span></h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/before.png" style="width:90.0%"></p>
<figcaption>Raw data</figcaption>
</figure>
</div>
</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/after_no_border.png" style="width:90.0%"></p>
<figcaption>Flattened</figcaption>
</figure>
</div>
</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/after_with_mask_no_border.png" style="width:90.0%"></p>
<figcaption>Grains detected</figcaption>
</figure>
</div>
</div></div>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Python toolkit for automated processing of atomic force microscopy (AFM) data.</li>
<li>Free and open-source research software</li>
<li>Developed by a small team at the University of Sheffield</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Takes raw noisy, non-flat images</li>
<li>Flattens them</li>
<li>Detects structures in the data</li>
<li>Calculates statistics for the structures</li>
</ul>
</div></div>
</section>
<section id="rse-topostats" class="slide level2">
<h2><span style="color:white">RSE &amp; TopoStats</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment"><strong>2020-04</strong> <a href="https://rse.shef.ac.uk/support/code-clinic/" target="_blank">RSE Code Clinic</a> - Python 2.7 deprecation &amp; Gwyddion</li>
<li class="fragment"><strong>2021-03</strong> RSE Support - Containerised to Docker</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/flattening_raw_afm_image.png"></p>
<figcaption>Raw Unprocessed AFM image</figcaption>
</figure>
</div>
</div></div>
<aside class="notes">
<p>Alice first contacted the RSE Team for assistance via the popular Code Clinics, these are half hour slots available every fortnight where you can come and chat with a member of RSE or IT services to get support with a programming related problem.</p>
<p>At the time a third party programme called Gwyddion was being used to do the processing. This was typically a Graphical User Interface (GUI) but it could be scripted using a Python package written in Python 2.7 which reached its end of life support in the previous year in 2019.</p>
<p>It was becoming problematic to install and maintain packages, and temporary work arounds were achieved.</p>
<p>Unfortunately that wasn‚Äôt the end of the groups woes and in 2021 RSE support was provided to containerise the workflow using a system called Docker. This provides the ability to run code in very specific environments which in this case included the increasingly necrotic Python 2.7 which interfaced with Gwyddion which was doing all the hard work of processing images.</p>
<p>Containerising the workflow sort of helped, but is substituted one set of woes for installing and maintaining outdated software with another set of problems, namely a convoluted workflow‚Ä¶</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="dependencies" class="slide level2">
<h2><span style="color:white">Dependencies</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Gwyddion</p>
<ul>
<li>AFM analysis software</li>
<li>Written in C++</li>
<li>Almost no code comments</li>
<li>Slow to use (GUI only)</li>
<li>No automation</li>
<li>No standardisation</li>
<li>Near impossible to contribute to / edit</li>
</ul>
</div><div class="column" style="width:50%;">
<p>PyGwy</p>
<ul>
<li>Python binding to Gwyddion‚Äôs methods and functions.</li>
<li>Written in outdated Python 2.7</li>
<li>Will <em>not</em> be updated</li>
<li>Lacking in documentation</li>
<li>Difficult to contribute to</li>
</ul>
</div></div>
<aside class="notes">
<p>Read through these bullet points</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="march-2022-installation-procedure" class="slide level2">
<h2><span style="color:white">March 2022: Installation procedure</span></h2>
<div class="fragment fade-in">
<h3 id="install-software">Install software</h3>
<div>
<ul>
<li class="fragment">Uninstall all python, gwydidon, pygobject, pycairo, pygtk installations</li>
<li class="fragment">Delete all caches of the above softwares</li>
<li class="fragment">Install Anaconda 32 bit ()</li>
<li class="fragment">Install Python 2.7</li>
<li class="fragment">Install pycharm (register for an account if necessary)</li>
<li class="fragment">Install Gwyddion</li>
<li class="fragment">Download a set of additional files from Google drive, hosted by the lab</li>
</ul>
</div>
</div>
<aside class="notes">
<p>Read through these bullet points</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="march-2022-installation-procedure-cont." class="slide level2">
<h2><span style="color:white">March 2022: Installation procedure (<em>cont.</em>)</span></h2>
<div class="fragment fade-in">
<h3 id="set-up-the-environment">Set up the environment</h3>
<div>
<ul>
<li class="fragment">Import the environment from the <code>gwyconda.yml</code> file.</li>
<li class="fragment">Follow some images to determine which checkboxes to select.</li>
<li class="fragment">Locate your python environment</li>
<li class="fragment">Install the PyGTK2 packages:
<ul>
<li class="fragment">Install PyGTK</li>
<li class="fragment">Install PyCairo</li>
<li class="fragment">Install PyGObject</li>
<li class="fragment">Manually add the paths for these into Anaconda</li>
</ul></li>
<li class="fragment">Change the Gwyconda environment directory to the bin folder in Gwyddion</li>
</ul>
</div>
</div>
<aside class="notes">
<p>Read through these bullet points</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="march-2022-installation-procedure-cont.-cont." class="slide level2">
<h2><span style="color:white">March 2022: Installation procedure (<em>cont. cont.</em>)</span></h2>
<div class="fragment fade-in">
<h3 id="set-up-pycharm">Set up PyCharm</h3>
<div>
<ul>
<li class="fragment">Open a new project and set the interpreter to Gwyconda</li>
<li class="fragment">Create a python file</li>
<li class="fragment">Append the path of the bin folder in Gwyddion</li>
<li class="fragment">Ignore all runtime warnings</li>
<li class="fragment"><span class="emoji" data-emoji="boom">üí•</span> <span style="color:red">Go back to the start because something went wrong in the installation</span> <span class="emoji" data-emoji="boom">üí•</span></li>
<li class="fragment"><span class="emoji" data-emoji="microscope">üî¨</span> <span class="emoji" data-emoji="crying_cat_face">üòø</span></li>
</ul>
</div>
</div>
<aside class="notes">
<p>Read through these bullet points</p>
<p>And it lead to sad Atmoic Force Microscopists!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="software-woes" class="slide level2">
<h2><span style="color:white">Software Woes</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="usage">Usage</h3>
<ul>
<li>Very hard to install</li>
<li>Outdated dependencies</li>
<li>Hard-coded values</li>
<li>Buggy!</li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="extending">Extending</h3>
<ul>
<li>Contributing was a mess</li>
<li>No versioning, no releases</li>
<li>No review process</li>
<li>No tests</li>
</ul>
</div></div>
<p><strong>Hardly anyone used or knew about it</strong></p>
<aside class="notes">
<p>This meant that working on TopoStats was confusing, difficult and prone to errors and lost data / scripts.</p>
<p>In summary the software was hard to install because it relied on outdated dependencies. Changing parameters was difficult because they were all hard coded and there were various bugs that kept on biting people.</p>
<p>Contributing and extending the software to add functionality was also challenging, there was no versioning or releases, code wasn‚Äôt peer reviewed and there were no tests in place which are useful to make sure that when you do make changes to the code base you are not breaking other areas.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="fair4rs-principles" class="slide level2">
<h2><span style="color:white">FAIR(4RS) Principles</span></h2>
<div>
<ul>
<li class="fragment"><strong>F</strong>indable
<ul>
<li class="fragment">Easy to find, with a unique identifier for each version ‚ùå</li>
<li class="fragment">Metadata (summary info, eg License, Website, coding language) ‚ùå</li>
</ul></li>
<li class="fragment"><strong>A</strong>ccessible
<ul>
<li class="fragment">Retrievable using a free and open protocol ‚úÖ</li>
<li class="fragment">Metadata are accessible, even when the software is no longer available ‚ùå</li>
</ul></li>
<li class="fragment"><strong>I</strong>nteroperable
<ul>
<li class="fragment">Software uses data in a way that meets community standards ‚úÖ</li>
<li class="fragment">Software includes references to other objects ‚ùå</li>
</ul></li>
<li class="fragment"><strong>R</strong>eusable
<ul>
<li class="fragment">Metadata (how to use) and License ‚ùå</li>
<li class="fragment">Detailled provenance (information on its context, maintainers and dependencies) ‚ùå</li>
</ul></li>
<li class="fragment"><span class="emoji" data-emoji="microscope">üî¨</span> <span class="emoji" data-emoji="crying_cat_face">üòø</span> + <span class="emoji" data-emoji="computer">üíª</span> <span class="emoji" data-emoji="crying_cat_face">üòø</span></li>
</ul>
</div>
<p><a href="https://doi.org/10.15497/RDA00068" target="_blank">FAIR Principles for Research Software (FAIR4RS Principles) doi:10.15497/RDA00068</a></p>
<aside class="notes">
<p>The FAIR principles which were originally developed for how research data should be handled have been adapted for Research Software and stipulate that the code should be‚Ä¶</p>
<p>Findable, with a unique identifier for each version and metadata that summarises the code, its license, language and so forth.</p>
<p>Accessible, that its easy to retrieve using an open protocol and that thte metadata remain accessible even when the software is no longer available.</p>
<p>Interoperable where it uses data in a way that meets community standards, we got another tick there, but it didn‚Äôt reference other objects.</p>
<p>Reusable with clear metadata and license on how to reuse the software and details on the maintinaers and dependencies.</p>
<p>This lead to not only sad micrscopists but also sad Research Software Engineers</p>
<p>What could we do about this?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="topostats-2.0" class="slide level2">
<h2><span style="color:white">‚ú® TopoStats 2.0 ‚ú®</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Remove external dependencies</li>
<li>Re-write all functionality in Python 3
<ul>
<li>Modular object-orientated design</li>
<li><span style="font:tiny">small</span> functions/methods</li>
<li>unit tests of functions/methods</li>
<li>regression tests for overall processing</li>
</ul></li>
<li>Configuration via plain-text YAML <span class="emoji" data-emoji="point_right">üëâ</span></li>
<li>Configurations saved with output (reproducibility)</li>
<li>Processes images in parallel <span class="emoji" data-emoji="people_holding_hands">üßë‚Äçü§ù‚Äçüßë</span></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource {yaml} number-lines code-with-copy"><code class="sourceCode"><span id="cb1-1"><a></a>base_dir: ./ # Directory in which to search for data files</span>
<span id="cb1-2"><a></a>output_dir: ./output # Directory to output results to</span>
<span id="cb1-3"><a></a>log_level: info # Verbosity of output. Options: warning, error, info, debug</span>
<span id="cb1-4"><a></a>cores: 2 # Number of CPU cores to utilise for processing multiple files simultaneously.</span>
<span id="cb1-5"><a></a>file_ext: .spm # File extension of the data files.</span>
<span id="cb1-6"><a></a>loading:</span>
<span id="cb1-7"><a></a>  channel: Height # Channel to pull data from in the data files.</span>
<span id="cb1-8"><a></a>  extract: raw # Array to extract when loading .topostats files.</span>
<span id="cb1-9"><a></a>filter:</span>
<span id="cb1-10"><a></a>  run: true # Options : true, false</span>
<span id="cb1-11"><a></a>  row_alignment_quantile: 0.5 # lower values may improve flattening of larger features</span>
<span id="cb1-12"><a></a>  threshold_method: std_dev # Options : otsu, std_dev, absolute</span>
<span id="cb1-13"><a></a>  otsu_threshold_multiplier: 1.0</span>
<span id="cb1-14"><a></a>  threshold_std_dev:</span>
<span id="cb1-15"><a></a>    below: 10.0 # Threshold for data below the image background</span>
<span id="cb1-16"><a></a>    above: 1.0 # Threshold for data above the image background</span>
<span id="cb1-17"><a></a>  threshold_absolute:</span>
<span id="cb1-18"><a></a>    below: -1.0 # Threshold for data below the image background</span>
<span id="cb1-19"><a></a>    above: 1.0 # Threshold for data above the image background</span>
<span id="cb1-20"><a></a>  gaussian_size: 1.0121397464510862 # Gaussian blur intensity in px</span>
<span id="cb1-21"><a></a>  gaussian_mode: nearest # Mode for Gaussian blurring. Options : nearest, reflect, constant, mirror, wrap</span>
<span id="cb1-22"><a></a>  # Scar remvoal parameters. Be careful with editing these as making the algorithm too sensitive may</span>
<span id="cb1-23"><a></a>  # result in ruining legitimate data.</span>
<span id="cb1-24"><a></a>  remove_scars:</span>
<span id="cb1-25"><a></a>    run: false</span>
<span id="cb1-26"><a></a>    removal_iterations: 2 # Number of times to run scar removal.</span>
<span id="cb1-27"><a></a>    threshold_low: 0.250 # lower values make scar removal more sensitive</span>
<span id="cb1-28"><a></a>    threshold_high: 0.666 # lower values make scar removal more sensitive</span>
<span id="cb1-29"><a></a>    max_scar_width: 4 # Maximum thickness of scars in pixels.</span>
<span id="cb1-30"><a></a>    min_scar_length: 16 # Minimum length of scars in pixels.</span>
<span id="cb1-31"><a></a>grains:</span>
<span id="cb1-32"><a></a>  run: true # Options : true, false</span>
<span id="cb1-33"><a></a>  # Thresholding by height</span>
<span id="cb1-34"><a></a>  threshold_method: std_dev # Options : std_dev, otsu, absolute, unet</span>
<span id="cb1-35"><a></a>  otsu_threshold_multiplier: 1.0</span>
<span id="cb1-36"><a></a>  threshold_std_dev:</span>
<span id="cb1-37"><a></a>    below: 10.0 # Threshold for grains below the image background</span>
<span id="cb1-38"><a></a>    above: 1.0 # Threshold for grains above the image background</span>
<span id="cb1-39"><a></a>  threshold_absolute:</span>
<span id="cb1-40"><a></a>    below: -1.0 # Threshold for grains below the image background</span>
<span id="cb1-41"><a></a>    above: 1.0 # Threshold for grains above the image background</span>
<span id="cb1-42"><a></a>  direction: above # Options: above, below, both (defines whether to look for grains above or below thresholds or both)</span>
<span id="cb1-43"><a></a>  # Thresholding by area</span>
<span id="cb1-44"><a></a>  smallest_grain_size_nm2: 50 # Size in nm^2 of tiny grains/blobs (noise) to remove, must be &gt; 0.0</span>
<span id="cb1-45"><a></a>  absolute_area_threshold:</span>
<span id="cb1-46"><a></a>    above: [300, 3000] # above surface [Low, High] in nm^2 (also takes null)</span>
<span id="cb1-47"><a></a>    below: [null, null] # below surface [Low, High] in nm^2 (also takes null)</span>
<span id="cb1-48"><a></a>  remove_edge_intersecting_grains: true # Whether or not to remove grains that touch the image border</span>
<span id="cb1-49"><a></a>  unet_config:</span>
<span id="cb1-50"><a></a>    model_path: null # Path to a trained U-Net model</span>
<span id="cb1-51"><a></a>    grain_crop_padding: 2 # Padding to apply to the grain crop bounding box</span>
<span id="cb1-52"><a></a>    upper_norm_bound: 5.0 # Upper bound for normalisation of input data. This should be slightly higher than the maximum desired / expected height of grains.</span>
<span id="cb1-53"><a></a>    lower_norm_bound: -1.0 # Lower bound for normalisation of input data. This should be slightly lower than the minimum desired / expected height of the background.</span>
<span id="cb1-54"><a></a>  vetting:</span>
<span id="cb1-55"><a></a>    class_conversion_size_thresholds: null # Class conversion size thresholds, list of tuples of 3 integers and 2 integers, ie list[tuple[tuple[int, int, int], tuple[int, int]]] eg [[[1, 2, 3], [5, 10]]] for each region of class 1 to convert to 2 if smaller than 5 nm^2 and to class 3 if larger than 10 nm^2.</span>
<span id="cb1-56"><a></a>    class_region_number_thresholds: null # Class region number thresholds, list of lists, ie [[class, low, high],] eg [[1, 2, 4], [2, 1, 1]] for class 1 to have 2-4 regions and class 2 to have 1 region. Can use None to not set an upper/lower bound.</span>
<span id="cb1-57"><a></a>    class_size_thresholds: null # Class size thresholds (nm^2), list of tuples of 3 integers, ie [[class, low, high],] eg [[1, 100, 1000], [2, 1000, None]] for class 1 to have 100-1000 nm^2 and class 2 to have 1000-any nm^2. Can use None to not set an upper/lower bound.</span>
<span id="cb1-58"><a></a>    nearby_conversion_classes_to_convert: null # Class conversion for nearby regions, list of tuples of two-integer tuples, eg [[[1, 2], [3, 4]]] to convert class 1 to 2 and 3 to 4 for small touching regions</span>
<span id="cb1-59"><a></a>    class_touching_threshold: 5 # Number of dilation steps to use for detecting touching regions</span>
<span id="cb1-60"><a></a>    keep_largest_labelled_regions_classes: null # Classes to keep the only largest regions for, list of integers eg [1, 2] to keep only the largest regions of class 1 and 2</span>
<span id="cb1-61"><a></a>    class_connection_point_thresholds: null # Class connection point thresholds, [[[class_1, class_2], [min, max]]] eg [[[1, 2], [1, 1]]] for class 1 to have 1 connection point with class 2</span>
<span id="cb1-62"><a></a>grainstats:</span>
<span id="cb1-63"><a></a>  run: true # Options : true, false</span>
<span id="cb1-64"><a></a>  edge_detection_method: binary_erosion # Options: canny, binary erosion. Do not change this unless you are sure of what this will do.</span>
<span id="cb1-65"><a></a>  cropped_size: -1 # Length (in nm) of square cropped images (can take -1 for grain-sized box)</span>
<span id="cb1-66"><a></a>  extract_height_profile: true # Extract height profiles along maximum feret of molecules</span>
<span id="cb1-67"><a></a>disordered_tracing:</span>
<span id="cb1-68"><a></a>  run: true # Options : true, false</span>
<span id="cb1-69"><a></a>  min_skeleton_size: 10 # Minimum number of pixels in a skeleton for it to be retained.</span>
<span id="cb1-70"><a></a>  pad_width: 1 # Pixels to pad grains by when tracing</span>
<span id="cb1-71"><a></a>  mask_smoothing_params:</span>
<span id="cb1-72"><a></a>    gaussian_sigma: 2 # Gaussian smoothing parameter 'sigma' in pixels.</span>
<span id="cb1-73"><a></a>    dilation_iterations: 2 # Number of dilation iterations to use for grain smoothing.</span>
<span id="cb1-74"><a></a>    holearea_min_max: [0, null] # Range (min, max) of a hole area in nm to refill in the smoothed masks.</span>
<span id="cb1-75"><a></a>  skeletonisation_params:</span>
<span id="cb1-76"><a></a>    method: topostats # Options : zhang | lee | thin | topostats</span>
<span id="cb1-77"><a></a>    height_bias: 0.6 # Percentage of lowest pixels to remove each skeletonisation iteration. 1 equates to zhang.</span>
<span id="cb1-78"><a></a>  pruning_params:</span>
<span id="cb1-79"><a></a>    method: topostats # Method to clean branches of the skeleton. Options : topostats</span>
<span id="cb1-80"><a></a>    max_length: 10.0 # Maximum length in nm to remove a branch containing an endpoint.</span>
<span id="cb1-81"><a></a>    height_threshold: # The height to remove branches below.</span>
<span id="cb1-82"><a></a>    method_values: mid # The method to obtain a branch's height for pruning. Options : min | median | mid.</span>
<span id="cb1-83"><a></a>    method_outlier: mean_abs # The method to prune branches based on height. Options : abs | mean_abs | iqr.</span>
<span id="cb1-84"><a></a>nodestats:</span>
<span id="cb1-85"><a></a>  run: true # Options : true, false</span>
<span id="cb1-86"><a></a>  node_joining_length: 7.0 # The distance in nanometres over which to join nearby crossing points.</span>
<span id="cb1-87"><a></a>  node_extend_dist: 14.0 # The distance in nanometres over which to join nearby odd-branched nodes.</span>
<span id="cb1-88"><a></a>  branch_pairing_length: 20.0 # The length in nanometres from the crossing point to pair and trace, obtaining FWHM's.</span>
<span id="cb1-89"><a></a>  pair_odd_branches: false # Whether to try and pair odd-branched nodes. Options: true and false.</span>
<span id="cb1-90"><a></a>  pad_width: 1 # Pixels to pad grains by when tracing (should be the same as disordered_tracing).</span>
<span id="cb1-91"><a></a>ordered_tracing:</span>
<span id="cb1-92"><a></a>  run: true</span>
<span id="cb1-93"><a></a>  ordering_method: nodestats # The method of ordering the disordered traces.</span>
<span id="cb1-94"><a></a>  pad_width: 1 # Pixels to pad grains by when tracing (should be the same as disordered_tracing).</span>
<span id="cb1-95"><a></a>splining:</span>
<span id="cb1-96"><a></a>  run: true # Options : true, false</span>
<span id="cb1-97"><a></a>  method: "rolling_window" # Options : "spline", "rolling_window"</span>
<span id="cb1-98"><a></a>  rolling_window_size: 20.0e-9 # size in nm of the rolling window.</span>
<span id="cb1-99"><a></a>  spline_step_size: 7.0e-9 # The sampling rate of the spline in metres.</span>
<span id="cb1-100"><a></a>  spline_linear_smoothing: 5.0 # The amount of smoothing to apply to linear features.</span>
<span id="cb1-101"><a></a>  spline_circular_smoothing: 5.0 # The amount of smoothing to apply to circular features.</span>
<span id="cb1-102"><a></a>  spline_degree: 3 # The polynomial degree of the spline.</span>
<span id="cb1-103"><a></a>curvature:</span>
<span id="cb1-104"><a></a>  run: true # Options : true, false</span>
<span id="cb1-105"><a></a>  colourmap_normalisation_bounds: [-0.5, 0.5] # Radians per nm to normalise the colourmap to.</span>
<span id="cb1-106"><a></a>plotting:</span>
<span id="cb1-107"><a></a>  run: true # Options : true, false</span>
<span id="cb1-108"><a></a>  style: topostats.mplstyle # Options : topostats.mplstyle or path to a matplotlibrc params file</span>
<span id="cb1-109"><a></a>  savefig_format: null # Options : null, png, svg or pdf. tif is also available although no metadata will be saved. (defaults to png) See https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.savefig.html</span>
<span id="cb1-110"><a></a>  savefig_dpi: 100 # Options : null (defaults to the value in topostats/plotting_dictionary.yaml), see https://afm-spm.github.io/TopoStats/main/configuration.html#further-customisation and https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.savefig.html</span>
<span id="cb1-111"><a></a>  pixel_interpolation: null # Options : https://matplotlib.org/stable/gallery/images_contours_and_fields/interpolation_methods.html</span>
<span id="cb1-112"><a></a>  image_set: core # Options : all, core</span>
<span id="cb1-113"><a></a>  zrange: [null, null] # low and high height range for core images (can take [null, null]). low &lt;= high</span>
<span id="cb1-114"><a></a>  colorbar: true # Options : true, false</span>
<span id="cb1-115"><a></a>  axes: true # Options : true, false (due to off being a bool when parsed)</span>
<span id="cb1-116"><a></a>  num_ticks: [null, null] # Number of ticks to have along the x and y axes. Options : null (auto) or integer &gt; 1</span>
<span id="cb1-117"><a></a>  cmap: null # Colormap/colourmap to use (default is 'nanoscope' which is used if null, other options are 'afmhot', 'viridis' etc.)</span>
<span id="cb1-118"><a></a>  mask_cmap: blue_purple_green # Options : blu, jet_r and any in matplotlib</span>
<span id="cb1-119"><a></a>  histogram_log_axis: false # Options : true, false</span>
<span id="cb1-120"><a></a>summary_stats:</span>
<span id="cb1-121"><a></a>  run: true # Whether to make summary plots for output data</span>
<span id="cb1-122"><a></a>  config: null</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<aside class="notes">
<p>We decided to rewrite TopoStats from the ground up, removing the external dependency on outdated Python 2.7 and re-implement all the steps in Python 3.</p>
<p>This mean we could take a modular, object-orientated design writing small functions and methods which are easy to write unit-tests to ensure they function as expected. As the software grew we also included regerssion tests to ensure the components worked together and the overall functionality was maintained.</p>
<p>Instead of having hard-coded configuration options these were all extracted out into a plain-text YAML configuration file and this configuration file was save along with output so that the work was reproducible in the future.</p>
<p>We also introduced parallel processing which meant that batches of images could be processed much quicker.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="documentation" class="slide level2">
<h2><span style="color:white">Documentation</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Every function, class and file is annotated in-line with <code>docstrings</code>.</li>
<li class="fragment">Describe the parameters and return values</li>
<li class="fragment">They make the code easier to read</li>
<li class="fragment">The documentation is built and deployed automatically to a website</li>
<li class="fragment">Easily searchable online</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/topostats_docs.png"></p>
<figcaption><a href="https://afm-spm.github.io/TopoStats" target="_blank">https://afm-spm.github.io/TopoStats</a></figcaption>
</figure>
</div>
</div></div>
<aside class="notes">
<p>At the same time we documented the functions classes and files with <code>docstrings</code> which describe the parmaters that go into teach function and what the function returns, this is what is known as the API, Application Programming Interface.</p>
<p>This makes it easier for others, including your future self, to read and understand the code.</p>
<p>We added documentation that described how to install and use the software and what the different steps of processing are and it included automatically the API documentation from the code giving a reference library that is easy online and easy to search.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="versioning" class="slide level2">
<h2><span style="color:white">Versioning</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Git version control of all code</li>
<li class="fragment">Versioned releases made automatically from GitHub to PyPI</li>
<li class="fragment">Documentation is versioned too</li>
<li class="fragment">Users have stable software whilst new features are developed</li>
<li class="fragment">Old versions archived and available</li>
<li class="fragment">DOI via <a href="https://figshare.shef.ac.uk/articles/software/TopoStats/22633528/1" target="_blank">ORDA</a>
<ul>
<li class="fragment"><a href="https://figshare.shef.ac.uk/articles/software/TopoStats/22633528/1" target="_blank"><img data-src="img/doi.png"></a></li>
</ul></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/github_releases.png" alt="GitHub Releases"> <img data-src="img/pypi_releases.png" alt="PyPI Releases"></p>
</div></div>
<aside class="notes">
<p>All of the code was version controlled using the Git Version Control Software.</p>
<p>This mean we could make versioned releases not just to GitHub but also the Python Package Index and we could version our documentation for each releas so that users have stable software to use whils new features are developed.</p>
<p>Old versions are archived and available via a unique Digital Object Identifier (DOI) which points to the software on the Universities Figshare instance ORDA</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="linting-and-formatting" class="slide level2">
<h2><span style="color:white">Linting and Formatting</span></h2>
<p>Make code universally understandable :::{.incremental}</p>
<ul>
<li><a href="https://www.pylint.org/" target="_blank">Pylint</a>, <a href="https://docs.astral.sh/ruff/" target="_blank">ruff</a>, <a href="https://github.com/psf/black" target="_blank">black</a></li>
<li>Code checked automatically on Git commit via <a href="https://pre-commit.com" target="_blank">pre-commit</a></li>
<li>Pull-requests run checks via Continuous Integration :::</li>
</ul>
<p><img data-src="img/pylint.png" alt="Pylint errors"> <img data-src="img/pre-commit-ci.png" alt="Pre-commit in CI"></p>
<aside class="notes">
<p>When writing the code we apply linting and formatting standards which make it easier to understand as the layout and style conforms to a (mostly) universally accepted standard. This is important not just for new people reading the code but also your future self when returning to code you‚Äôve not touched in three months or in my case sometimes just a week!</p>
<p>These are applied automatically when making commits to the versioning software Git and also run in Continuous Integration when merging new features.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="tests" class="slide level2">
<h2><span style="color:white">Tests</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Extensive test-suite</li>
<li class="fragment">Unit tests for each function</li>
<li class="fragment">Integration tests</li>
<li class="fragment">Stability!</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/ci_tests.png"></p>
<figcaption>Tests passing in Continuous Integration</figcaption>
</figure>
</div>
</div></div>
<aside class="notes">
<p>As we re-wrote the code base we introduced a comprehensive test suite with unit-tests that ensure that each small function behaves and does what it is supposed to.</p>
<p>As the software grew we introduced integration tests to ensure that the components within the package work together as they were meant to.</p>
<p>This mean the software was more stable, when changes were made to one area of the code base it ensured that it didn‚Äôt break things elsewhere and it gives us greater confidence that the code works and the ability to undertake refactoring to re-write sections of code if the need arises.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="code-review" class="slide level2">
<h2><span style="color:white">Code review</span></h2>
<ul>
<li>Open process</li>
<li>Contribution using GitHub‚Äôs Pull Requests</li>
<li>Requires approval from at least one other person
<ul>
<li>Prevents bad code from being added to the project</li>
<li>Ensures against single-point of failure</li>
</ul></li>
</ul>
<p><img data-src="img/review.png"></p>
</section>
<section id="topostats-2.0-installation-and-usage" class="slide level2">
<h2><span style="color:white">TopoStats 2.0 Installation and Usage</span></h2>
<h3 id="installation">Installation</h3>
<pre><code>conda create -n topostats-311 python=3.11
conda activate topostats-311
pip install topostats</code></pre>
<h3 id="usage-1">Usage</h3>
<pre><code>topostats process

[Thu, 27 Feb 2025 14:27:42] [INFO    ] [topostats] Processing : minicircle
[Thu, 27 Feb 2025 14:27:42] [INFO    ] [topostats] [minicircle] : *** Filtering ***
[Thu, 27 Feb 2025 14:27:45] [INFO    ] [topostats] [minicircle] : Plotting Filtering Images
[Thu, 27 Feb 2025 14:27:46] [INFO    ] [topostats] [minicircle] : Filters stage completed successfully.
[Thu, 27 Feb 2025 14:27:46] [INFO    ] [topostats] [minicircle] : *** Grain Finding ***
[Thu, 27 Feb 2025 14:27:47] [INFO    ] [topostats] [minicircle] : Grains found for direction above : 21
[Thu, 27 Feb 2025 14:27:47] [INFO    ] [topostats] [minicircle] : Plotting Grain Finding Images
[Thu, 27 Feb 2025 14:27:47] [INFO    ] [topostats] [minicircle] : Grain Finding stage completed successfully.
[Thu, 27 Feb 2025 14:27:47] [INFO    ] [topostats] [minicircle] : *** Grain Statistics ***
[Thu, 27 Feb 2025 14:27:48] [INFO    ] [topostats] [minicircle] : Calculated grainstats for 21 grains.
[Thu, 27 Feb 2025 14:27:48] [INFO    ] [topostats] [minicircle] : Grainstats stage completed successfully.
[Thu, 27 Feb 2025 14:27:48] [INFO    ] [topostats] [minicircle] : *** Disordered Tracing ***
[Thu, 27 Feb 2025 14:27:49] [INFO    ] [topostats] [minicircle] : Calculating Disordered Tracing statistics for 21 grains...
[Thu, 27 Feb 2025 14:27:59] [INFO    ] [topostats] [minicircle] : Disordered Tracing stage completed successfully.
[Thu, 27 Feb 2025 14:27:59] [INFO    ] [topostats] [minicircle] : *** Nodestats ***
[Thu, 27 Feb 2025 14:27:59] [INFO    ] [topostats] [minicircle] : Calculating NodeStats statistics for 21 grains...
[Thu, 27 Feb 2025 14:28:00] [INFO    ] [topostats] [minicircle] : NodeStats stage completed successfully.
[Thu, 27 Feb 2025 14:28:00] [INFO    ] [topostats] [minicircle] : *** Ordered Tracing ***
[Thu, 27 Feb 2025 14:28:00] [INFO    ] [topostats] [minicircle] : Calculating Ordered Traces and statistics for 21 grains...
[Thu, 27 Feb 2025 14:28:03] [INFO    ] [topostats] [minicircle] : Ordered Tracing stage completed successfully.
[Thu, 27 Feb 2025 14:28:03] [INFO    ] [topostats] [minicircle] : *** Splining ***
[Thu, 27 Feb 2025 14:28:03] [INFO    ] [topostats] [minicircle] : Calculating Splining statistics for 25 molecules...
[Thu, 27 Feb 2025 14:28:04] [INFO    ] [topostats] [minicircle] : Splining stage completed successfully.
[Thu, 27 Feb 2025 14:28:04] [INFO    ] [topostats] [minicircle] : *** Curvature Stats ***
[Thu, 27 Feb 2025 14:28:05] [INFO    ] [topostats] [minicircle] : *** Image Statistics ***
[Thu, 27 Feb 2025 14:28:05] [INFO    ] [topostats] [minicircle] : Saving image to .topostats file
Processing images from /home/neil/work/git/hub/AFM-SPM/TopoStats, results are under output:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå                                                                                                                                                     | 1/2 [00:23&lt;00:23, 23.33s/it][Thu, 27 Feb 2025 14:28:06] [INFO    ] [topostats] [minicircle] Processing completed.
Processing images from /home/neil/work/git/hub/AFM-SPM/TopoStats, results are under output:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå                                                                                                                                                     | 1/2 [00:23&lt;00:23, 23.33s/it]
[Thu, 27 Feb 2025 14:28:06] [INFO    ] [topostats] Saving image stats to : output/image_stats.csv.
[Thu, 27 Feb 2025 14:28:06] [INFO    ] [topostats] Saving all height profiles to output/height_profiles.json
[Thu, 27 Feb 2025 14:28:06] [INFO    ] [topostats] The YAML summarisation config is valid.
[Thu, 27 Feb 2025 14:28:06] [INFO    ] [topostats] [plotting] Default variable to labels mapping loaded.
[Thu, 27 Feb 2025 14:28:06] [INFO    ] [topostats] Summary plots and statistics will be saved to : output/summary_distributions
[Thu, 27 Feb 2025 14:28:08] [INFO    ] [topostats] Folder-wise statistics saved to: output/tmp/filter/folder_grain_stats.csv
[Thu, 27 Feb 2025 14:28:08] [INFO    ] [topostats] Folder-wise statistics saved to: output/tmp/filter/folder_disordered_trace_stats.csv
[Thu, 27 Feb 2025 14:28:08] [INFO    ] [topostats] Folder-wise statistics saved to: output/tmp/filter/folder_mol_stats.csv
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


  _______      _____      __ __       _____     ______    _______      _____      _______    ______
/\_______)\   ) ___ (    /_/\__/\    ) ___ (   / ____/\ /\_______)\   /\___/\   /\_______)\ / ____/\
\(___  __\/  / /\_/\ \   ) ) ) ) )  / /\_/\ \  ) ) __\/ \(___  __\/  / / _ \ \  \(___  __\/ ) ) __\/
  / / /     / /_/ (_\ \ /_/ /_/ /  / /_/ (_\ \  \ \ \     / / /      \ \(_)/ /    / / /      \ \ \
 ( ( (      \ \ )_/ / / \ \ \_\/   \ \ )_/ / /  _\ \ \   ( ( (       / / _ \ \   ( ( (       _\ \ \
  \ \ \      \ \/_\/ /   )_) )      \ \/_\/ /  )____) )   \ \ \     ( (_( )_) )   \ \ \     )____) )
  /_/_/       )_____(    \_\/        )_____(   \____\/    /_/_/      \/_/ \_\/    /_/_/     \____\/


[Thu, 27 Feb 2025 14:28:08] [INFO    ] [topostats]

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ COMPLETE ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

  TopoStats Version           : 2.3.2.dev27+gbe8d296d1
  Base Directory              : /home/neil/work/git/hub/AFM-SPM/TopoStats
  File Extension              : .spm
  Files Found                 : 2
  Successfully Processed^1    : 1 (50.0%)
  All statistics              : output/all_statistics.csv
  Distribution Plots          : output/summary_distributions

  Configuration               : output/config.yaml

  Email                       : topostats@sheffield.ac.uk
  Documentation               : https://afm-spm.github.io/topostats/
  Source Code                 : https://github.com/AFM-SPM/TopoStats/
  Bug Reports/Feature Request : https://github.com/AFM-SPM/TopoStats/issues/new/choose
  Citation File Format        : https://github.com/AFM-SPM/TopoStats/blob/main/CITATION.cff

  ^1 Successful processing of an image is detection of grains and calculation of at least
     grain statistics. If these have been disabled the percentage will be 0.

  If you encounter bugs/issues or have feature requests please report them at the above URL
  or email us.

  If you have found TopoStats useful please consider citing it. A Citation File Format is
  linked above and available from the Source Code page.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</code></pre>
</section>
<section id="extensibility---detangling" class="slide level2">
<h2><span style="color:white">Extensibility - Detangling</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>New functionality for disentangling molecules</li>
<li><a href="https://www.biorxiv.org/content/10.1101/2024.06.28.601212v2" target="_blank"><strong>Under or Over? Tracing Complex DNA Structures with High Resolution Atomic Force Microscopy</strong></a> (under review at <em>Nat Comms</em>)</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/pairing.png"> <img data-src="img/ns_sep_mols.png"> <img data-src="img/splining.png"></p>
</div></div>
</section>
<section id="extensibility---splinning" class="slide level2">
<h2><span style="color:white">Extensibility - Splinning</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Splining of traces</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/splining.png"></p>
</div></div>
</section>
<section id="three-years-on" class="slide level2">
<h2><span style="color:white">Three years on</span></h2>
<div>
<ul>
<li class="fragment"><strong>F</strong>indable
<ul>
<li class="fragment">Easy to find, with a unique identifier for each version ‚úÖ</li>
<li class="fragment">Metadata (summary info, eg License, Website, coding language) ‚úÖ</li>
</ul></li>
<li class="fragment"><strong>A</strong>ccessible
<ul>
<li class="fragment">Retrievable using a free and open protocol ‚úÖ</li>
<li class="fragment">Metadata are accessible, even when the software is no longer available ‚úÖ</li>
</ul></li>
<li class="fragment"><strong>I</strong>nteroperable
<ul>
<li class="fragment">Software uses data in a way that meets community standards ‚úÖ</li>
<li class="fragment">Software includes references to other objects ‚úÖ</li>
</ul></li>
<li class="fragment"><strong>R</strong>eusable
<ul>
<li class="fragment">Metadata (how to use) and License ‚úÖ</li>
<li class="fragment">Detailled provenance (information on its context, maintainers and dependencies) ‚úÖ</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<p><span class="emoji" data-emoji="tada">üéâ</span> <a href="https://www.sheffield.ac.uk/openresearch/casestudies" target="_blank">TUOS Open Research Prize 2023 Team Winners</a> <span class="emoji" data-emoji="tada">üéâ</span></p>
</div>
</section>
<section id="shared-skills-and-knowledge" class="slide level2">
<h2><span style="color:white">Shared Skills and Knowledge</span></h2>
<div>
<ul>
<li class="fragment"><em>Not</em> an individual endeavour!</li>
<li class="fragment">Researchers and PhD students wrote a <em>lot</em> of code</li>
<li class="fragment">Code review ensure many know and understand how it works
<ul>
<li class="fragment">No single point of failure</li>
</ul></li>
<li class="fragment"><em>Team</em> adopted good working practices</li>
<li class="fragment">Important training and transferable skills</li>
</ul>
</div>
<aside class="notes">
<p>This was far from an individual endevaour, I wasn‚Äôt parachuted in and made lots of changes to the code implementing everything myself. Researchers and PhD students wrote a lot of code.</p>
<p>By having peer review in place via code reviews it ensure that multiple people understand how it all works, there is no single point of failure.</p>
<p>Importantly the whole team adopted good working practices and this provided important training in tranferable skills that people could take with them as they move into the wider area of work. Just recently an ex-PhD student secured a job with the Research Software Engineering team at the University of Birmingham.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="benefits-and-drawbacks-of-open-research-software" class="slide level2">
<h2>Benefits and drawbacks of Open Research / Software</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="benefits">Benefits</h3>
<p>Openness Leads to‚Ä¶</p>
<ul>
<li>Collaboration
<ul>
<li>Sharing data, methods, code</li>
<li>Faster and efficient progress (‚Ä¶most of the time!)</li>
<li>Fosters community</li>
</ul></li>
<li>Inclusivity
<ul>
<li>Data and software are free to access</li>
</ul></li>
<li>Greater impact
<ul>
<li>More accessible to a wider audience</li>
</ul></li>
<li>Transparency and constructive criticism
<ul>
<li>Enables and even encourages people to critique methods that are used.</li>
</ul></li>
<li>Reproduciblility
<ul>
<li>Others can more easily replicate research</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="drawbacks">Drawbacks</h3>
<ul>
<li>Chaos in open software development
<ul>
<li>As the community grows, so do the feature requests and issues!</li>
<li>Competing demands of users, collaborators, work</li>
<li>Sporadic nature of working with people with varying availability</li>
</ul></li>
</ul>
</div></div>
<aside class="notes">
<p>There are pros and cons to changing the way you work with software, collaboration with the RSE team has led to a better understanding within the team of the methods and code, ir runs faster and is a more efficient process of developing software (most of the time!).</p>
<p>The software is more inclusive and its free to access, as a consequence it is reaching a wider audience and we are seeing researchers from other laboratries trying it out and finding that its better than the existing tools they use, they are reporting issues and making feature requests.</p>
<p>The open software development enables people to make constructive criticism of the software implementation and our approach to development.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="acknowledgements" class="slide level2">
<h2>Acknowledgements</h2>
<p>I would like to thank everyone who has worked on and helped with TopoStats. This was a massive group effort.</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Alice Pyne</li>
<li>Billie Ward</li>
<li>Bob Turner</li>
<li>Eddie Rollins</li>
<li>Jean Du</li>
<li>Joe Beton</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Laura Wiggins</li>
<li>Libby Holmes</li>
<li>Max Gamill</li>
<li>Neil Shephard</li>
<li>Rob Moorehead</li>
<li>Sylvia Whittle</li>
<li>Tobi Firth</li>
</ul>
</div></div>


<div class="reveal-header">
<div class="header-logo">
<img data-src="">
</div>
<div class="sc-title">
<p> </p>
</div>
<div class="header-text">
<p>RSE TopoStats Case Study</p>
</div>
<div class="sb-title">
<p> </p>
</div>
</div>
</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><strong>Slides</strong> : <a href="https://ns-rse.github.io/topostats-showcase" target="_blank"><strong>ns-rse.github.io/topostats-showcase</strong></a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-confetti/confetti.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'confetti': {"particleCount":50,"angle":90,"spread":45,"startVelocity":45,"decay":0.9,"gravity":1,"drift":0,"ticks":200,"colors":null,"shapes":null,"scalar":1,"zIndex":100,"disableForReducedMotion":false},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'speaker',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealConfetti, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/ns-rse\.github\.io\/topostats-showcase");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>